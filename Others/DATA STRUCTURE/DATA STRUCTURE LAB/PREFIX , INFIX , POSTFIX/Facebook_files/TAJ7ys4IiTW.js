/*!CK:2266768544!*//*1459901565,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["W6Cgc"]); }

__d("GenderConst",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={NOT_A_PERSON:0,FEMALE_SINGULAR:1,MALE_SINGULAR:2,FEMALE_SINGULAR_GUESS:3,MALE_SINGULAR_GUESS:4,MIXED_SINGULAR:5,MIXED_PLURAL:5,NEUTER_SINGULAR:6,UNKNOWN_SINGULAR:7,FEMALE_PLURAL:8,MALE_PLURAL:9,NEUTER_PLURAL:10,UNKNOWN_PLURAL:11,UNKNOWN:0};},null);
__d('MercuryAttachmentError.react',['fbt','XUINotice.react','XUIText.react','React'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').createClass({displayName:'MercuryAttachmentError',render:function(){return (c('React').createElement(c('XUINotice.react'),{use:'warn'},c('React').createElement(c('XUIText.react'),{size:'small'},h._("This attachment could not be loaded."))));}});f.exports=i;},null);
__d('PhotoResizeMath',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={getScaledPhotoDimensions:function(i,j,k,l,m){var n=i/j,o=k/l;if(k&&l&&m==='stretch')return {width:k,height:l};if(!k&&l||m==='contain'!==n>=o)return {width:l*n,height:l};if(k)return {width:k,height:k/n};return {width:i,height:j};}};f.exports=h;},null);
__d('PixelzFocus',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={search:function(i,j){var k=0,l=i.length-1;while(k<=l){var m=k+Math.floor((l-k)/2),n=i[m];if(n>j){l=m-1;}else if(n<j){k=m+1;}else return m;}return Math.min(k,l);},forceSpecificPoint:function(i,j,k){var l=1e-09,m=h.search(i,j-k-l)+1,n=h.search(i,j+k);return i.slice(m,n+1);},findBiggestSets:function(i,j){var k=[],l=-1;for(var m=0;m<i.length;++m){var n=i[m],o=m,p=h.search(i,n+j),q=p-o;if(q>l)k=[];if(q>=l){l=q;k.push({low:o,high:p});}}return k;},getBestSet:function(i,j,k){var l=-1,m=null;for(var n=0;n<j.length;++n){var o=j[n],p=i[o.low],q=i[o.high],r=p+(q-p)/2,s=Math.min(p-(r-k),r+k-q);if(s>l){l=s;m=o;}}return m;},getFocusFromSet:function(i,j){var k=i[j.low],l=i[j.high];return k+(l-k)/2;},clampFocus:function(i,j){var k=j/2,l=1-j/2;if(i<k)return k;if(i>l)return l;return i;},convertFromCenterToCSS:function(i,j){if(Math.abs(1-j)<1e-05)return 0;return (i-j/2)/(1-j);},convertFromCSSToCenter:function(i,j){return i*(1-j)+j/2;},getVisible:function(i,j){if(i<j)return i/j;return j/i;},getHidden:function(i,j){return 1-h.getVisible(i,j);},focusHorizontally:function(i,j){return i<j;},convertVectorFromCenterToCSS:function(i,j,k){var l=h.focusHorizontally(j,k),m;if(l){m=i.x/100;}else m=i.x/100;var n=h.convertFromCenterToCSS(m,h.getVisible(j,k));if(l){return {x:n,y:0};}else return {x:0,y:n};},getCropRect:function(i,j,k){var l=h.focusHorizontally(j,k),m=h.getVisible(j,k);if(l){var n=(1-m)*i.x;return {left:n,top:0,width:m,height:1};}else{var o=(1-m)*i.y;return {left:0,top:o,width:1,height:m};}}};f.exports=h;},null);
__d('loadImage',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,j){var k=new Image();k.onload=function(){j(k.width,k.height,k);};k.src=i;}f.exports=h;},null);
__d('Pixelz.react',['cx','arrayContains','loadImage','joinClasses','React','PhotoResizeMath','PixelzFocus'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'Pixelz',propTypes:{width:i.number,height:i.number,resizeMode:i.oneOf(['contain','cover','stretch']),alt:i.string,letterbox:i.bool,borderRadius:i.number,insetBorderColor:i.string,animated:i.bool,upscale:i.bool,cropRect:function(k,l,m){var n=k[l],o='Invalid prop `'+l+'` supplied to `'+m+'`, expected a rectangle with values normalized '+'between 0 and 1.';if(n.left<0||n.top<0||n.width<0||n.height<0||n.left+n.width>1||n.top+n.height>1)return new Error(o);},focus:function(k,l,m){var n=k[l],o='Invalid prop `'+l+'` supplied to `'+m+'`, expected either a {x, y, type} vector where type '+'is `css` or `center` or an array of {x, y} vectors. All the vectors '+'have with values normalized between 0 and 1.';if(Array.isArray(n)){for(var p=0;p<n.length;++p)if(!(n[p].x>=0&&n[p].x<=1)||!(n[p].y>=0&&n[p].y<=1))return new Error(o);}else{if(!n.type)n.type='css';if(!(n.x>=0&&n.x<=1)||!(n.y>=0&&n.y<=1)||!c('arrayContains')(['center','css'],n.type))return new Error(o);}}},getDefaultProps:function(){return {resizeMode:'cover',alt:'',letterbox:true,upscale:true,cropRect:{width:1,height:1,top:0,left:0},focus:{x:.5,y:.5,type:'css'}};},getInitialState:function(){return {srcDimensions:{}};},getSrcDimensions:function(){var k=this.props.src,l=this.state.srcDimensions[k];if(l)return l;c('loadImage')(k,function(m,n){var o={};o[k]={width:m,height:n};this.isMounted()&&this.setState({srcDimensions:o});}.bind(this));return null;},getCropSrcDimensions:function(){var k=this.getSrcDimensions();return {width:k.width*this.props.cropRect.width,height:k.height*this.props.cropRect.height};},getUpscaleCropDimensions:function(){var k=this.getCropSrcDimensions();return c('PhotoResizeMath').getScaledPhotoDimensions(k.width,k.height,this.props.width,this.props.height,this.props.resizeMode);},getCropDimensions:function(){var k=this.getUpscaleCropDimensions(),l=this.getCropSrcDimensions();if(!this.props.upscale)return {width:Math.min(k.width,l.width),height:Math.min(k.height,l.height)};return k;},getCropAspectRatio:function(){var k=this.getCropDimensions();return k.width/k.height;},getContainerDimensions:function(){if(this.props.letterbox&&this.props.width&&this.props.height)return {width:this.props.width,height:this.props.height};return this.getCropDimensions();},getContainerAspectRatio:function(){var k=this.getContainerDimensions();return k.width/k.height;},getContainerPosition:function(){return {left:0,top:0};},getFocus:function(){var k=this.props.focus;if(!Array.isArray(k)&&k.type==='css')return {x:k.x,y:k.y};var l=this.getContainerAspectRatio(),m=this.getCropAspectRatio(),n=c('PixelzFocus').getVisible(l,m),o=c('PixelzFocus').focusHorizontally(l,m),p;if(!Array.isArray(k)){p=c('PixelzFocus').convertFromCenterToCSS(o?k.x:k.y,n);}else{var q=k.map(function(t){return o?t.x:t.y;});q.sort();var r=c('PixelzFocus').findBiggestSets(q,n),s=c('PixelzFocus').getBestSet(q,r,n);p=c('PixelzFocus').getFocusFromSet(q,s);}return {x:o?p:.5,y:o?.5:p};},getCropPosition:function(){var k=this.getCropDimensions(),l=this.getContainerDimensions(),m=this.getFocus();return {left:m.x*(l.width-k.width),top:m.y*(l.height-k.height)};},getScaleDimensions:function(){var k=this.getCropDimensions();return {width:k.width/this.props.cropRect.width,height:k.height/this.props.cropRect.height};},getScalePosition:function(){var k=this.getScaleDimensions();return {left:-k.width*this.props.cropRect.left,top:-k.height*this.props.cropRect.top};},getClipCropRectangle:function(){var k=this.getContainerDimensions(),l=this.getCropDimensions(),m=this.getContainerPosition(),n=this.getCropPosition(),o=Math.max(m.left,n.left),p=Math.max(m.top,n.top),q=Math.min(m.top+k.height,n.top+l.height),r=Math.min(m.left+k.width,n.left+l.width);return {left:o,top:p,width:r-o,height:q-p};},getClipCropPosition:function(){var k=this.getClipCropRectangle();return {left:k.left,top:k.top};},getClipCropDimensions:function(){var k=this.getClipCropRectangle();return {width:k.width,height:k.height};},getClipScalePosition:function(){var k=this.getScalePosition(),l=this.getClipCropPosition(),m=this.getCropPosition();return {left:k.left+(m.left-l.left),top:k.top+(m.top-l.top)};},getClipScaleDimensions:function(){return this.getScaleDimensions();},areDimensionsEqual:function(k,l){return k.width===l.width&&k.height===l.height;},shouldAddAllNodesAndStyles:function(){return this.props.animated;},hasCrop:function(){if(this.shouldAddAllNodesAndStyles())return true;var k=this.getContainerDimensions(),l=this.getClipCropDimensions(),m=this.getClipScaleDimensions();if(this.areDimensionsEqual(k,l)||this.areDimensionsEqual(l,m))return false;return true;},hasContainer:function(){if(this.shouldAddAllNodesAndStyles()||this.hasInsetBorder())return true;var k=this.getContainerDimensions(),l=this.getClipScaleDimensions();if(this.areDimensionsEqual(k,l))return false;return true;},hasInsetBorder:function(){return this.shouldAddAllNodesAndStyles()||this.props.insetBorderColor;},applyPositionStyle:function(k,l){if(this.shouldAddAllNodesAndStyles()||l.left)k.left=Math.round(l.left);if(this.shouldAddAllNodesAndStyles()||l.top)k.top=Math.round(l.top);},applyDimensionsStyle:function(k,l){k.width=Math.round(l.width);k.height=Math.round(l.height);},applyBorderRadiusStyle:function(k){if(this.shouldAddAllNodesAndStyles()||this.props.borderRadius)k.borderRadius=this.props.borderRadius||0;},getScaleStyle:function(){var k={},l=this.getClipCropDimensions(),m=this.getClipScaleDimensions();if(this.shouldAddAllNodesAndStyles()||!this.areDimensionsEqual(l,m)){this.applyPositionStyle(k,this.getClipScalePosition());}else this.applyPositionStyle(k,this.getClipCropPosition());this.applyDimensionsStyle(k,this.getClipScaleDimensions());this.applyBorderRadiusStyle(k);return k;},getCropStyle:function(){var k={};this.applyPositionStyle(k,this.getClipCropPosition());this.applyDimensionsStyle(k,this.getClipCropDimensions());this.applyBorderRadiusStyle(k);return k;},getInsetBorderStyle:function(){var k={borderColor:this.props.insetBorderColor||'transparent'};this.applyPositionStyle(k,this.getClipCropPosition());this.applyDimensionsStyle(k,this.getClipCropDimensions());this.applyBorderRadiusStyle(k);return k;},getContainerStyle:function(){var k={};this.applyDimensionsStyle(k,this.getContainerDimensions());this.applyBorderRadiusStyle(k);return k;},getScale:function(){var k=this.getScaleStyle(),l=k.width,m=k.height;k=babelHelpers['extends']({},k);delete k.width;delete k.height;return (c('React').createElement('img',babelHelpers['extends']({},this.props,{alt:this.props.alt,className:c('joinClasses')(this.props.className,"_56wb"+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":'')),src:this.props.src,style:babelHelpers['extends']({},this.props.style||{},k),width:l,height:m})));},getCrop:function(){var k=this.getScale();if(!this.hasCrop())return k;return (c('React').createElement('div',{className:"_56ma"+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":''),style:this.getCropStyle()},k));},getInsetBorder:function(){if(!this.hasInsetBorder())return null;return (c('React').createElement('div',{className:"_56lv"+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":''),style:this.getInsetBorderStyle()}));},getContainer:function(){var k=this.getCrop();if(!this.hasContainer())return k;var l=this.getInsetBorder();return (c('React').createElement('div',{className:"_56jj"+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":''),'data-skipchecker':null,style:this.getContainerStyle()},k,l));},render:function(){var k=this.getSrcDimensions();if(!k)return c('React').createElement('span',{'data-skipchecker':null});return this.getContainer();}});f.exports=j;},null);
__d('BanzaiScribe',['Banzai'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(j){return {log:function(k,l,m){var n=[l];if(m!=null)n.push(m);c('Banzai').post('scribe:'+k,n,j);}};}var i=h({});i.create=h;f.exports=i;},null);
__d('ChatImageArrowDirection',['keyMirror'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('keyMirror')({BOTH:null,LEFT:null,RIGHT:null});f.exports=h;},null);
__d('WebMessengerPermalinks',['MercuryAPIArgsSource','MercuryFilters','MercuryIDs','MercuryParticipants','MercuryParticipantTypes','MercuryThreadIDMap','MercuryTypeaheadConstants','MessagingTag','WebMessengerOldToNewPermalink','WebMessengerPermalinkConstants','WebMessengerStateConstants','WebMessengerStateStore','MercuryThreads','Token','URI','WebMessengerPreferences','WWWBase','MercuryUnreadState','createCancelableFunction','goURI','isWebMessengerURI'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('MercuryThreadIDMap').get(),i=c('MercuryThreads').get(),j='(/|\\?|$)';c('MercuryParticipants');c('MercuryIDs');var k={getDefaultURI:function(){var x=new (c('URI'))(c('WWWBase').uri);x.setPath(c('WebMessengerPermalinkConstants').BASE_PATH);return x;},goNextURI:function(x,y,z,aa){if(t(x,y,z)){var ba=k.getURI(x,y,z);c('goURI')(ba,false,aa);return true;}return false;},getURI:function(x,y,z){var aa=k.getDefaultURI();if(!x||!y||!z)return aa;switch(z.folder){case c('MessagingTag').OTHER:aa.setPath(c('WebMessengerPermalinkConstants').OTHER_PATH);break;case c('MessagingTag').ACTION_ARCHIVED:aa.setPath(c('WebMessengerPermalinkConstants').ARCHIVED_PATH);break;case c('MessagingTag').SPAM:aa.setPath(c('WebMessengerPermalinkConstants').SPAM_PATH);break;case c('MessagingTag').PENDING:aa.setPath(c('WebMessengerPermalinkConstants').PENDING_PATH);break;}if(z.filter&&z.filter!=c('MercuryFilters').ALL)aa.addQueryData({filter:z.filter});var ba;switch(x){case c('WebMessengerStateConstants').MASTER.SEARCH:ba=false;aa.setPath(aa.getPath()+c('WebMessengerPermalinkConstants').SEARCH_POSTFIX_PATH);break;}switch(y){case c('WebMessengerStateConstants').DETAIL.COMPOSE_MAIN:case c('WebMessengerStateConstants').DETAIL.COMPOSE_TYPEAHEAD_RESULTS:case c('WebMessengerStateConstants').DETAIL.COMPOSE_ALL_PEOPLE_RESULTS:aa.setPath(aa.getPath()+c('WebMessengerPermalinkConstants').COMPOSE_POSTFIX_PATH);ba=false;break;case c('WebMessengerStateConstants').DETAIL.RECENT_MESSAGES:ba=!z.thread_id;break;case c('WebMessengerStateConstants').DETAIL.SEARCH_CONTEXT:case c('WebMessengerStateConstants').DETAIL.SHARED_PHOTOS:ba=false;break;default:ba=true;break;}if(ba)aa.addQueryData({action:y});if(z.thread_id){var ca=c('MercuryIDs').getUserIDFromThreadID(z.thread_id),da=ca&&c('MercuryParticipants').getNow(c('MercuryIDs').getParticipantIDFromUserID(ca));if(da&&da.type!==c('MercuryParticipantTypes').EVENT){var ea=da&&da.vanity||ca;aa.setPath(c('WebMessengerPermalinkConstants').getURIPathForIDOrVanity(ea,aa.getPath()));}else{var fa=h.getServerIDFromClientIDNow(z.thread_id),ga=fa?fa:z.thread_id;aa.setPath(c('WebMessengerPermalinkConstants').getURIPathForThreadID(ga,aa.getPath()));}}if(z.query)aa.addQueryData({query:z.query});if(z.message_query)aa.addQueryData({mquery:z.message_query});if(z.message_id)aa.addQueryData({mid:z.message_id});if(z.reuse_composer)aa.addQueryData({rc:true});if(z.isStandaloneMode)aa.addQueryData({standalone:true});return aa;},processURI:function(x,y){x=c('WebMessengerOldToNewPermalink')(x);if(!c('isWebMessengerURI')(x))return y(false);var z,aa=u(x),ba=!aa.master_state||!aa.detail_state;if(ba){z=v(x);}else{z={data:{folder:r(x),filter:s(x)},redirect:false,master_state:aa.master_state,detail_state:aa.detail_state};if(x.getQueryData().rc)z.data.reuse_composer=true;z=o(x,z);}z.data.isStandaloneMode=x.getQueryData().standalone;if(ba)return y(z);switch(aa.detail_state){case c('WebMessengerStateConstants').DETAIL.RECENT_MESSAGES:return q(x,z,y);case c('WebMessengerStateConstants').DETAIL.COMPOSE_MAIN:return l(x,z,y);case c('WebMessengerStateConstants').DETAIL.SEARCH_SNIPPET:return p(x,z,y);case c('WebMessengerStateConstants').DETAIL.SEARCH_CONTEXT:return q(x,z,function(ca){p(x,ca,function(da){n(x,da,y);});});}z.redirect=true;z.detail_state=null;return y(z);}};function l(x,y,z){var aa=null;if(x.getQueryData().to)aa=[].concat(x.getQueryData().to);z(m(aa,y));}function m(x,y){if(x){y.data.new_tokens=[];x.forEach(function(z){var aa=c('MercuryParticipants').getNow(c('MercuryIDs').getParticipantIDFromUserID(z));if(aa){var ba={uid:z,text:aa.name,type:c('MercuryTypeaheadConstants').USER_TYPE};y.data.new_tokens.push(new (c('Token'))(ba));}});}y.data.start=true;return y;}function n(x,y){var z=x.getQueryData().mid;if(z){y.data.message_id=z;}else y.redirect=true;return y;}function o(x,y){var z=x.getQueryData().query;y.data.query=z;return y;}function p(x,y,z){var aa=x.getQueryData().mquery;y.data.message_query=aa;z(y);}function q(x,y,z){var aa=c('WebMessengerPermalinkConstants').getThreadIDFromURI(x);if(aa){var ba=c('MercuryIDs').isValidThreadID(aa)?aa:h.getClientIDFromServerIDNow(aa);if(ba){y.data.thread_id=ba;}else y.redirect=true;}else{var ca=c('WebMessengerPermalinkConstants').getUserIDOrVanity(x.getPath());if(ca){var da=c('MercuryParticipants').getIDFromVanityOrFBID(ca);if(!da){if(!y.waiting){y.waiting=true;y.retry=c('createCancelableFunction')(function(){q(x,y,z);});c('MercuryParticipants').addListener('change',y.retry);z(y);}return;}var ea=da&&i.getCanonicalThreadToParticipant(da,null,c('MercuryAPIArgsSource').WEBMESSENGER);if(ea){delete y.waiting;if(y.retry)y.retry.cancel();if(ea.timestamp){y.data.thread_id=ea.thread_id;}else{y.detail_state=c('WebMessengerStateConstants').DETAIL.COMPOSE_MAIN;y=m([c('MercuryIDs').getUserIDFromParticipantID(da)],y);}}else y.redirect=true;}}z(y);}function r(x,y){var z=x.getPath();if(z.match('^'+c('WebMessengerPermalinkConstants').ARCHIVED_PATH+j))return c('MessagingTag').ACTION_ARCHIVED;if(z.match('^'+c('WebMessengerPermalinkConstants').OTHER_PATH+j))return c('MessagingTag').OTHER;if(z.match('^'+c('WebMessengerPermalinkConstants').SPAM_PATH+j))return c('MessagingTag').SPAM;if(z.match('^'+c('WebMessengerPermalinkConstants').PENDING_PATH+j))return c('MessagingTag').PENDING;if(y!==undefined)return y;return c('MessagingTag').INBOX;}function s(x){return x.getQueryData().filter||c('MercuryFilters').ALL;}function t(x,y,z){if(y===c('WebMessengerStateConstants').DETAIL.SEARCH_CONTEXT||y===c('WebMessengerStateConstants').DETAIL.SEARCH_THREAD_SNIPPET||y===c('WebMessengerStateConstants').DETAIL.SHARED_PHOTOS)return false;if(z&&z.no_uri===true){delete z.no_uri;return false;}var aa=y==c('WebMessengerStateConstants').DETAIL.COMPOSE_MAIN||y==c('WebMessengerStateConstants').DETAIL.COMPOSE_TYPEAHEAD_RESULTS||y==c('WebMessengerStateConstants').DETAIL.COMPOSE_ALL_PEOPLE_RESULTS;if(aa&&(!z.start||z.new_tokens))return false;if(!x||!y||!z)return true;if(z.bug_reporting_enabled)return false;return !z.message_action;}function u(x){var y={},z=x.getPath(),aa=x.getQueryData(),ba=z.match(c('WebMessengerPermalinkConstants').BASE_PATH+'(/[^/]+)?'+c('WebMessengerPermalinkConstants').SEARCH_POSTFIX_PATH+j);y.master_state=ba&&aa.query?c('WebMessengerStateConstants').MASTER.SEARCH:c('WebMessengerStateConstants').MASTER.RECENT_THREADS;if(aa.action){y.detail_state=aa.action;return y;}if(z.match('(?:'+c('WebMessengerPermalinkConstants').BASE_PATH+'|'+c('WebMessengerPermalinkConstants').OTHER_PATH+')'+'(/[^/]+)?'+c('WebMessengerPermalinkConstants').COMPOSE_POSTFIX_PATH+j)){y.detail_state=c('WebMessengerStateConstants').DETAIL.COMPOSE_MAIN;return y;}if(z.match(c('WebMessengerPermalinkConstants').TID_POSTFIX_PARTIAL_PATH)||c('WebMessengerPermalinkConstants').getUserIDOrVanity(z)){if(aa.mid&&aa.mquery){y.detail_state=c('WebMessengerStateConstants').DETAIL.SEARCH_CONTEXT;}else y.detail_state=c('WebMessengerStateConstants').DETAIL.RECENT_MESSAGES;}else if(aa.mquery)y.detail_state=c('WebMessengerStateConstants').DETAIL.SEARCH_SNIPPET;return y;}function v(x){var y=r(x,null)||c('WebMessengerStateStore').getLastSeenFolder(),z=c('WebMessengerStateStore').getLastSeenThreadID()||w(y||c('MessagingTag').INBOX),aa=c('MercuryUnreadState').get();if(y===c('MessagingTag').OTHER&&aa.getUnreadCount(y)===0){var ba=c('MessagingTag').INBOX;if(aa.exceedsMaxCount(ba)||aa.getUnreadCount(ba)>0)y=ba;}var ca={redirect:!!z||!!y,replace:true,master_state:c('WebMessengerStateConstants').MASTER.RECENT_THREADS,detail_state:c('WebMessengerStateConstants').DETAIL.RECENT_MESSAGES,data:{folder:y||c('MessagingTag').INBOX,filter:c('MercuryFilters').ALL,thread_id:z}};return ca;}function w(x){var y=c('WebMessengerPreferences').lastReadThreadForFolder[x];if(y){var z=y.other_user_fbid||y.thread_fbid;return h.getClientIDFromServerIDNow(z);}else return null;}f.exports=k;},null);
__d('MercuryDataSources',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={},i={add:function(j,k){h[j]=k;},get:function(j){!h[j];return h[j];}};f.exports=i;},null);
__d("Autosize",["cx","CSS","DOM","Style"],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=['fontFamily','fontStyle','fontVariant','fontWeight','letterSpacing','textDecoration','textIndent','textTransform','whiteSpace','wordSpacing','wordWrap'],j=/^[0-9]+$/;function k(p){var q=p.cloneNode(true);c("CSS").addClass(q,"_4g");var r=p.clientWidth-c("Style").getFloat(p,'paddingLeft')-c("Style").getFloat(p,'paddingRight');c("Style").set(q,'width',r+'px');var s=p.clientHeight-c("Style").getFloat(p,'paddingTop')-c("Style").getFloat(p,'paddingBottom');c("Style").set(q,'height',s+'px');c("DOM").insertAfter(p,q);return q;}function l(p,q,r,s,t){var u=p.style.fontSize,v=p.style.height;c("Style").set(p,"height","auto");if(q!==null){var w=p.style.width;c("Style").set(p,"width","auto");}var x=0,y=t.length-1;while(x<y){var z=Math.ceil((x+y)/2);c("Style").set(p,"font-size",t[z]+s);if(r!==null&&p.scrollHeight>r||q!==null&&p.scrollWidth>q){y=z-1;}else x=z;}p.style.fontSize=u;p.style.height=v;if(q!==null)p.style.width=w;return t[x]+s;}function m(p,q,r,s,t,u){var v=p.style.fontSize,w=p.style.height;c("Style").set(p,"height","auto");if(q!==null){var x=p.style.width;c("Style").set(p,"width","auto");}c("Style").set(p,"font-size",u+s);if((r===null||p.scrollHeight<=r)&&(q===null||p.scrollWidth<=q)){p.style.fontSize=v;p.style.height=w;if(q!==null)p.style.width=x;return u+s;}c("Style").set(p,"font-size",t+s);if(r!==null&&p.scrollHeight>r||q!==null&&p.scrollWidth>q){p.style.fontSize=v;p.style.height=w;if(q!==null)p.style.width=x;return t+s;}while(t+1<u){var y=Math.ceil((t+u)/2);c("Style").set(p,"font-size",y+s);if(r!==null&&p.scrollHeight>r||q!==null&&p.scrollWidth>q){u=y;}else t=y;}p.style.fontSize=v;p.style.height=w;if(q!==null)p.style.width=x;return t+s;}function n(p,q){this._wrap=p;this._attr=q;if(this._attr.sizes){var r=this._attr.sizes;for(var s=1,t=r.length;s<t;s++){if(r[s-1]<=r[s])continue;r.sort(function(v,w){return v-w;});break;}}else if(q.min>q.max){var u=q.min;q.min=q.max;q.max=u;}this.fit();}n.prototype.fit=function(p,q){var r=this._wrap;if(!r.clientWidth){o.push(this);return;}var s=k(r);if(typeof p==="undefined")p=this._attr.width;if(j.test(p)){s.style.width=p+"px";}else if(p!==null&&p!=="auto")s.style.width=p;if(typeof q==="undefined")q=this._attr.height;if(j.test(q)){s.style.height=q+"px";}else if(q!==null&&q!=="auto")s.style.height=q;var t=null;if(!this._attr.wrap)t=s.clientWidth;var u=null;if(this._attr.wrap||q!==null)u=s.clientHeight;var v;if(this._attr.sizes){v=l(s,t,u,"px",this._attr.sizes);}else v=m(s,t,u,"px",this._attr.min,this._attr.max);c("DOM").remove(s);c("Style").set(r,"font-size",v);c("CSS").removeClass(r,"invisible_elem");};var o=[];n.onNodeInserted=function(){var p=o;o=[];p.forEach(function(q){q.fit();});};f.exports=n;},null);
__d('SamplingPolicyBase',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(){'use strict';throw 'Tried to instantiate SamplingPolicyBase';}h.prototype.getName=function(){'use strict';return this.name;};h.prototype.isSampled=function(){'use strict';if(typeof this.sampled=='undefined')this.sampled=this.decideIfSampled();return this.sampled;};f.exports=h;},null);
__d('FbtraceForcedByServerPolicy',['FbtraceForcedByServer','SamplingPolicyBase'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h;function i(){this.name='FbtraceForcedByServerPolicy';}i.get=function(){if(typeof h=='undefined')h=new i();return h;};function j(){return c('FbtraceForcedByServer').forced;}Object.assign(i.prototype,c('SamplingPolicyBase').prototype,{decideIfSampled:j});f.exports=i;},null);
__d("guardFunction",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j,k){return function(){if(i.apply(k||this,arguments))j.apply(k||this,arguments);};}f.exports=h;},null);
__d('Fbtrace',['Arbiter','BanzaiScribe','ErrorUtils','FbtraceForcedByServer','FbtraceForcedByServerPolicy','Random','SiteData','guardFunction'],function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();var j='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',k='AAAAAAAAAAA';h=babelHelpers.inherits(l,Error);i=h&&h.prototype;function l(aa){i.constructor.call(this,aa);}function m(aa){c('ErrorUtils').reportError(new l(aa));}function n(){var aa=function(){var da=0,ea=0,fa='';for(var ga=10;ga>=0;ga--){if(da<6){ea=c('Random').uint32();da=32;}if(ga===0)ea=ea&7;fa=j.charAt(ea&63)+fa;ea>>=6;da-=6;}return fa;},ba,ca;for(ba=3;ba>0;ba--){ca=aa();if(ca!=k)return ca;}m('failed to generate valid Fbtrace id');return k;}function o(){Object.assign(this,o);}Object.assign(o,{isOn:function(){return false;},replySend:function(aa,ba){},requestSend:function(aa,ba,ca){u(aa,ba);return {metadata:function(){return undefined;},replyReceive:function(da){}};}});var p=new o();function q(aa,ba,ca){if(!aa)throw {name:'ArgumentError',message:'no valid service name specified'};if(!ba)throw {name:'ArgumentError',message:'no valid version specified'};var da=c('BanzaiScribe'),ea=0,fa=n(),ga=n(),ha=t(fa),ia={service:aa,version:ba},ja=function(oa){if(typeof oa=='undefined')return 'undefined';if(typeof oa!='string')oa=ja(JSON.stringify(oa));return oa;},ka=function(oa){var pa='';for(var qa in oa){if(pa.length>0)pa+='\x02';pa+=ja(qa)+'\x03'+ja(oa[qa]);}return pa;},la=function(oa,pa,event,qa,ra){ea++;return [ra,ea,fa,oa,pa,ja(event),ka(qa)].join('\x01');},ma=function(oa,pa,event,qa,ra){if(!ra&&typeof ra=='undefined')ra=Date.now()*1000;var sa=la(oa,pa,event,qa,ra);da.log('fbtrace',sa,ha);},na=function(){return ga;};ma(k,ga,'#rqrecv',Object.assign(ca||{},ia));Object.assign(this,q,{replySend:function(oa,pa){pa=babelHelpers['extends']({},pa,ia,{success:oa?'true':'false'});ma(k,ga,'#rpsend',pa);},requestSend:function(oa,pa,qa){u(oa,pa);var ra=na(),sa=n();qa=babelHelpers['extends']({},qa,ia,{op:oa,'remote:service':pa});ma(ra,sa,'#rqsend',qa);return {metadata:function(){return fa+sa;},replyReceive:function(ta){ma(ra,sa,'#rprecv',Object.assign(ta||{},ia));},parentNode:this};}});}Object.assign(q,{isOn:function(){return true;}});function r(){return p;}function s(aa,ba,ca){ca=ca||{};ca.init=true;var da=c('FbtraceForcedByServerPolicy').get();if(da.isSampled()){return new q(aa,ba,ca);}else return new o();}function t(aa){var ba=aa.charAt(aa.length-1);return j.indexOf(ba)%32;}function u(aa,ba){if(!aa)throw {name:'ArgumentError',message:'no valid operation specified'};if(!ba)throw {name:'ArgumentError',message:'no valid remote:service specified'};}function v(aa,ba){var ca=p,da;p=aa;try{da=ba();}finally{p=ca;}return da;}var w=function(aa,ba){var ca=r(),da=ba.request,ea=false;if(!ca.isOn()&&c('FbtraceForcedByServer').forced&&/\/upload\/(?:composer|photos)\/|\/ajax\/composerx\/attachment\/media\//.test(da.uri.toString())){ca=s('photo_upload_kludge',String(c('SiteData').revision||'dev'),{policy:'PhotoUpload'});ea=true;}if(ca.isOn()){var fa=ea?{policy:'PhotoUpload'}:{};if(da.userActionId)fa.user_action_id=da.userActionId;var ga=ca.requestSend(da.uri.toString(),'www',fa);da.fbtraceRemoteNode=ga;da.transport.setRequestHeader('X-Fbtrace-Meta',ga.metadata());}},x=function(aa,ba){ba.request.fbtraceRemoteNode.replyReceive({is_last:ba.response.is_last,success:true});setTimeout(function(){ba.request.fbtraceRemoteNode.parentNode.replySend(true,{});},0);},y=function(aa,ba){ba.request.fbtraceRemoteNode.replyReceive({is_last:ba.response.is_last,success:false,error_code:ba.response.error,error_summary:ba.response.errorSummary,error_description:ba.response.errorDescription});setTimeout(function(){ba.request.fbtraceRemoteNode.parentNode.replySend(false,{});},0);},z=function(aa,ba){return ba.request.fbtraceRemoteNode;};c('Arbiter').subscribe('AsyncRequest/will_send',w);c('Arbiter').subscribe('AsyncRequest/response',c('guardFunction')(z,x));c('Arbiter').subscribe('AsyncRequest/error',c('guardFunction')(z,y));f.exports={defaultNode:r,requestReceive:s,withDefaultNode:v,freshId:n};},null);
__d('StickerSearch',['StickerServerRequests'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h,i={requestStickersForQuery:function(j,k,l){h=j;c('StickerServerRequests').getStickersForQuery(j,k,function(m){return h===j&&l(m.payload);});}};f.exports=i;},null);
__d('StickersFlyoutStickerSelector.react',['cx','fbt','ix','BanzaiLogger','Grid.react','Image.react','ScrollableArea.react','React','Sticker.react','StickerConstants','StickerImages','StickerInterfaces','StickerSearch','StickerState','StickerUtils','XUISpinner.react','debounce','emptyFunction','getObjectValues','throttle'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=c('Grid.react').GridItem,l=c('React').PropTypes,m=320,n=278,o=c('StickerConstants').MRU_STICKER_PACK,p=44,q=112,r=c('debounce')(function(t,u){if(!t)return;c('BanzaiLogger').log('StickersLoggerConfig',{event:'search_sticker',searchtoken:t,numsearchresults:u.length});},1000),s=c('React').createClass({displayName:'StickersFlyoutStickerSelector',propTypes:{height:l.number,stickerInterface:l.oneOf(c('getObjectValues')(c('StickerInterfaces'))),onScroll:l.func,onStickerClick:l.func.isRequired,onStickerKeyDown:l.func.isRequired,packID:l.string,userInput:l.string},getDefaultProps:function(){return {stickerInterface:c('StickerInterfaces').MESSAGES,onScroll:c('emptyFunction')};},getInitialState:function(){return {loading:false,stickers:[]};},componentDidMount:function(){if(this.props.packID){this.requestStickersForPack(this.props.packID);return;}if(this.props.userInput)this.requestStickersForQuery(this.props.userInput,this.props.stickerInterface);},componentWillReceiveProps:function(t){if(t.packID&&t.packID!==this.props.packID){this.requestStickersForPack(t.packID);}else if(t.userInput!==this.props.userInput)this.requestStickersForQuery(t.userInput,this.props.stickerInterface);},requestStickersForQuery:function(t,u){this.setState({loading:true});c('StickerSearch').requestStickersForQuery(t,u,function(v){v.map(function(w){return c('StickerImages').cacheSticker(w);});if(!this.props.tagChosen)r(t,v);if(this.isMounted())this.setState({loading:false,stickers:v});}.bind(this));},requestStickersForPack:function(t){this.setState({loading:true});c('StickerImages').requestStickersForPack(t,c('StickerConstants').TRAY_SIZE,function(u){if(t==o){u=c('StickerState').getMRUStickerPack(u);if(this.props.stickerInterface==c('StickerInterfaces').COMPOSER)u=u.filter(function(v){return v.isComposerCapable;});if(this.props.stickerInterface==c('StickerInterfaces').COMMENTS)u=u.filter(function(v){return v.isCommentsCapable;});if(this.props.stickerInterface==c('StickerInterfaces').MESSAGES)u=u.filter(function(v){return v.isMessengerCapable;});}this.setState({loading:false,stickers:u});}.bind(this));},renderStickers:function(){return this.state.stickers.map(function(t){var u=c('StickerUtils').getScaledDimensions(t.height,t.width,c('StickerConstants').TRAY_SIZE);return (c('React').createElement(k,{key:t.id},c('React').createElement('div',{className:"_5r8h",onClick:function(event){return this.props.onStickerClick(t.id,event);}.bind(this),onKeyDown:function(event){return this.props.onStickerKeyDown(t.id,event);}.bind(this)},c('React').createElement(c('Sticker.react'),{accessibilityLabel:t.accessibilityLabel,animationTrigger:'hover',className:"_5r8i",forceCursorPointer:true,frameCount:t.frameCount,frameRate:t.frameRate||83,framesPerCol:t.framesPerCol,framesPerRow:t.framesPerRow,sourceHeight:u.height,sourceURI:t.sourceURI,sourceWidth:u.width,spriteURI:t.spriteURI,packName:t.packName,paddedSpriteURI:t.paddedSpriteURI,stickerID:t.id}))));}.bind(this));},_onScroll:function(){var t=this.refs.stickerScrollable;if(t){var u=t.getArea().getScrollTop();this.props.onScroll(u);}},render:function(){if(this.state.loading){return (c('React').createElement('div',{className:"_e0r"},c('React').createElement(c('XUISpinner.react'),{size:'large'})));}else if(this.state.stickers.length===0){var t=(m-p*2-q)/2+'px';return (c('React').createElement('div',{className:"_5jdt",style:{marginTop:t}},c('React').createElement(c('Image.react'),{src:j('/images/messaging/stickers/icons/sad_face.png')}),c('React').createElement('p',null,i._("No Stickers to Show"))));}return (c('React').createElement(c('ScrollableArea.react'),{ref:'stickerScrollable',height:this.props.height||m,onScroll:c('throttle')(this._onScroll,200),width:n,fade:true},c('React').createElement('div',{className:"_5r8k"},c('React').createElement(c('Grid.react'),{cols:4,fixed:true},this.renderStickers()))));}});f.exports=s;},null);
__d('VaultBoxURI',['URI'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={PHOTOS_SYNCED:'photos_synced',isVaultBoxURI:function(i){var j=new RegExp("\/"+h.PHOTOS_SYNCED+"\/?$");return i.getPath().match(j)&&i.getQueryData().hasOwnProperty('view_image');},isVaultArchiveURI:function(i){var j=new RegExp("\/"+h.PHOTOS_SYNCED+"\/?$");return i.getPath().match(j);},getSyncedTabURI:function(){return new (c('URI'))('/me/'+h.PHOTOS_SYNCED).getQualifiedURI();}};f.exports=h;},null);